# A03_wrapped

Converted this notebook on colab to a JS bookmarklet

Usage: 
1. If you drag this link [AO3 Wrapped]((javascript:void%20function(){(async%20function(){%22use%20strict%22;const%20a=prompt(%22Enter%20your%20AO3%20username:%22);if(!a)return;const%20b=parseInt(prompt(%22Which%20year%3F%20(e.g.,%202025)%22,%222025%22));if(!b)return;const%20c=document.createElement(%22div%22);c.style.cssText=%22position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);z-index:999999;display:flex;align-items:center;justify-content:center;color:%23fff;font-family:sans-serif;flex-direction:column;%22,c.innerHTML=%22%3Cdiv%20style=\%22font-size:24px;margin-bottom:20px;\%22%3E\uD83D\uDCDA%20Generating%20AO3%20Wrapped...%3C/div%3E%3Cdiv%20id=\%22ao3-progress\%22%20style=\%22font-size:16px;\%22%3EStarting...%3C/div%3E%22,document.body.appendChild(c);const%20d=document.getElementById(%22ao3-progress%22);try{async%20function%20e(a){d.textContent=%22Fetching%20%22+a.split(%22%3F%22)[0].split(%22/%22).pop()+%22...%22;const%20b=await%20fetch(a,{credentials:%22include%22});return%20new%20DOMParser().parseFromString(await%20b.text(),%22text/html%22)}const%20f=`https://archiveofourown.org/users/${a}/readings`,g=await%20e(f),h=g.querySelector(%22ol.pagination.actions%22),i=h%3FparseInt([...h.querySelectorAll(%22li%22)].slice(-2)[0].textContent):1;d.textContent=`Found%20${i}%20pages%20to%20scan...`;const%20j=[];for(let%20a=1;a%3C=i;a++){d.textContent=`Scanning%20page%20${a}/${i}...`;const%20c=await%20e(`${f}%3Fpage=${a}`),g=c.querySelectorAll(%22ol.reading.work.index.group%20li[role=\%22article\%22]%22),h=c.querySelectorAll(%22h4.viewed.heading%22);for(let%20c=0;c%3Cg.length;c++){const%20d=h[c].textContent;if(d.includes(%22Marked%20for%20Later%22)||d.includes(%22Deleted%20work%22))continue;const%20e=d.match(/(\d{4})/);if(!e)continue;const%20f=parseInt(e[1]);if(f%3Cb){a=i+1;break}if(f%3Eb)continue;const%20k=g[c],l=k.querySelector(%22h4.heading%20a%22).textContent.trim(),m=k.querySelector(%22a.help.symbol.question%22)%3F.textContent.trim()||%22Not%20Rated%22,n=[...k.querySelectorAll(%22a[rel=\%22author\%22]%22)].map(b=%3Eb.textContent.trim()),o=[...k.querySelectorAll(%22h5.fandoms.heading%20a.tag%22)].map(b=%3Eb.textContent.trim()),p=[...k.querySelectorAll(%22li.relationships%22)].map(a=%3Ea.textContent.replace(/\n/g,%22%22).trim()).filter(Boolean),q=[...k.querySelectorAll(%22li.characters%22)].map(a=%3Ea.textContent.replace(/\n/g,%22%22).trim()).filter(Boolean),r=[...k.querySelectorAll(%22li.freeforms%22)].map(a=%3Ea.textContent.replace(/\n/g,%22%22).trim()).filter(Boolean),s=parseInt(k.querySelector(%22dd.words%22)%3F.textContent.replace(/,/g,%22%22)||%220%22);j.push({title:l,rating:m,authors:n.length%3Fn:[%22Anonymous%22],fandoms:o,ships:p,chars:q,tags:r,words:s})}await%20new%20Promise(a=%3EsetTimeout(a,1e3))}if(!j.length)throw%20new%20Error(%22No%20fics%20found%20for%20this%20year!%22);d.textContent=%22Calculating%20stats...%22;const%20k=j.length,l=j.reduce((a,b)=%3Ea+b.words,0),m=j.reduce((a,b)=%3Eb.words%3Ea.words%3Fb:a,j[0]),o=a=%3Ea.reduce((a,b)=%3E(a[b]=(a[b]||0)+1,a),{}),p=(a,b)=%3EObject.entries(o(a)).sort((c,a)=%3Ea[1]-c[1]).slice(0,b),q=p(j.flatMap(a=%3Ea.authors).filter(b=%3E%22Anonymous%22!==b%26%26%22orphan_account%22!==b),5),r=p(j.flatMap(a=%3Ea.fandoms),3),s=p(j.flatMap(a=%3Ea.chars),2),t=p(j.flatMap(a=%3Ea.ships),5),u=p(j.flatMap(a=%3Ea.tags),5),v=p(j.map(a=%3Ea.rating),1),w=5e4%3El%3F%22You%20touch%20grass!%22:1e6%3El%3F%22That's%20like%20reading%20multiple%20novels!%22:`About%20${Math.floor(l/365)}%20words/day!`,x={Explicit:%22No%20judgement.%22,Mature:%22You're%20spicy.%22,%22Teen%20And%20Up%20Audiences%22:%22Jesus%20is%20proud.%22,%22General%20Audiences%22:%22Wholesome!%22}[v[0]%3F.[0]]||%22%22;let%20y=`%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90\n%20%20%20AO3%20WRAPPED%20${b}\n%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90\n\n`;y+=`%F0%9F%93%9A%20FICS%20READ:%20${k}\n`,y+=`%F0%9F%93%96%20WORDS:%20${l.toLocaleString()}\n%20%20%20${w}\n\n`,y+=`%F0%9F%93%9C%20LONGEST:%20%22${m.title}%22\n%20%20%20by%20${m.authors.join(%22,%20%22)}\n%20%20%20${m.words.toLocaleString()}%20words\n\n`,y+=`%F0%9F%8C%9F%20TOP%20FANDOMS:\n${r.map(([a,b],c)=%3E`%20%20%20${c+1}.%20${a}%20(${b})`).join(%22\n%22)}\n\n`,s.length%26%26(y+=`%F0%9F%91%A4%20FAV%20CHARACTERS:\n${s.map(([a,b])=%3E`%20%20%20%E2%80%A2%20${a}%20(${b})`).join(%22\n%22)}\n\n`),t.length%26%26(y+=`%F0%9F%92%95%20TOP%20SHIPS:\n${t.map(([a,b],c)=%3E`%20%20%20${c+1}.%20${a}%20(${b})`).join(%22\n%22)}\n\n`),q.length%26%26(y+=`%E2%9C%8D%EF%B8%8F%20TOP%20AUTHORS:\n${q.map(([b,a],c)=%3E`%20%20%20${c+1}.%20${b}%20(${a})`).join(%22\n%22)}\n\n`),u.length%26%26(y+=`%F0%9F%8F%B7%EF%B8%8F%20TOP%20TAGS:\n${u.map(([a,b],c)=%3E`%20%20%20${c+1}.%20${a}%20(${b})`).join(%22\n%22)}\n\n`),y+=`%F0%9F%94%9E%20RATING:%20${v[0]%3F.[0]||%22N/A%22}%20(${v[0]%3F.[1]||0}%20works)\n%20%20%20${x}\n\n`,y+=`%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90%E2%95%90`,c.innerHTML=`%20%20%20%20%20%20%3Cdiv%20style=%22max-width:800px;max-height:90vh;overflow:auto;background:%23fff;color:%23000;padding:30px;border-radius:12px;font-family:monospace;white-space:pre-wrap;%22%3E${y}%3C/div%3E%20%20%20%20%20%20%3Cdiv%20style=%22margin-top:20px;%22%3E%20%20%20%20%20%20%20%20%3Cbutton%20id=%22ao3-copy%22%20style=%22padding:12px%2024px;margin:0%2010px;font-size:16px;cursor:pointer;background:%23990000;color:%23fff;border:none;border-radius:6px;%22%3E%F0%9F%93%8B%20Copy%3C/button%3E%20%20%20%20%20%20%20%20%3Cbutton%20id=%22ao3-close%22%20style=%22padding:12px%2024px;margin:0%2010px;font-size:16px;cursor:pointer;background:%23666;color:%23fff;border:none;border-radius:6px;%22%3EClose%3C/button%3E%20%20%20%20%20%20%3C/div%3E%20%20%20%20`,document.getElementById(%22ao3-copy%22).onclick=()=%3E{navigator.clipboard.writeText(y),alert(%22Copied%20to%20clipboard!%22)},document.getElementById(%22ao3-close%22).onclick=()=%3Ec.remove()}catch(a){c.innerHTML=`%20%20%20%20%20%20%3Cdiv%20style=%22color:%23f88;font-size:20px;text-align:center;max-width:600px;%22%3E%20%20%20%20%20%20%20%20%E2%9D%8C%20Error:%20${a.message}%3Cbr%3E%3Cbr%3E%20%20%20%20%20%20%20%20Make%20sure%20you're%20logged%20into%20AO3%20and%20your%20username%20is%20correct.%20%20%20%20%20%20%20%20%3Cbr%3E%3Cbr%3E%20%20%20%20%20%20%20%20%3Cbutton%20onclick=%22this.parentElement.parentElement.remove()%22%20style=%22padding:12px%2024px;font-size:16px;cursor:pointer;background:%23666;color:%23fff;border:none;border-radius:6px;%22%3EClose%3C/button%3E%20%20%20%20%20%20%3C/div%3E%20%20%20%20`}})()}();)) to your toolbar, it should save as a bookmarklet.
2. Navigate to AO3 (make sure you're logged in!) and then click the bookmarklet
3. It will prompt for a year and your username (could probably also scrape this tbh)
4. then it will run the queries in the background (takes a few minutes) and then display the (text) results in a dialog box